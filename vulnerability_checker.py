import requests

class VulnerabilityChecker:
    def __init__(self, scan_results):
        self.scan_results = scan_results

    def check_vulnerabilities(self):
        print("Checking for vulnerabilities...")
        vulnerabilities = []
        for device in self.scan_results:
            ip = device['ip']
            # Example CVE check (adjust endpoint accordingly)
            cve_id = "CVE-2020-0601"  # Example CVE
            try:
                response = requests.get(f"https://services.nvd.nist.gov/rest/json/cves/1.0/{cve_id}")
                if response.status_code == 200:
                    vulnerabilities.append({'ip': ip, 'vulnerability': cve_id})
            except requests.exceptions.RequestException as e:
                print(f"Could not check {ip}: {e}")
        
        return vulnerabilities
